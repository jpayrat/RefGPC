{# src/vae/RefGPCBundle/Resources/views/Accueil/accueil.html.twig #}

{% extends "vaeRefGPCBundle::default.html.twig" %}

{% block title %}{{ parent() }} Les ilots {% endblock %}
{% block stylesheets %}{{ parent() }}{% endblock %}

{% block body %}
    
    <div class="row">
        <div class="col-lg-12 header"> 
            {{ include("vaeRefGPCBundle::navHorizontal.html.twig") }}
        </div>
    </div>
        
    <div class="row">
        <section class="col-lg-12 corps">
     
            <div class="col-lg-3 lateral_nav">
                {{ include("vaeRefGPCBundle::navVertical.html.twig") }}
            </div>
 
            <div class="col-lg-9 container">

                <div id="formIlot">
                <h1>Ilots GPC - {{ libelleBase }} - {{ nbIlots }} îlots // Code base : {{ codeBase }}</h1>
 
  
                <span id="reinitForm">Réinitialiser le formulaire</span><br />
                <span id="listAll">Lister tous les îlots</span><br />
        
                {{ form(form)}}
                </div>
        
                <div id="results_ilot">
                result ilot
                </div>

            </div>
        </section>
  </div>
        
    {{ include("vaeRefGPCBundle::piedPage.html.twig") }}
     
    {% block javascripts %}
        {{ parent() }}
        <script src="{{ asset('js/ilotFunctions.js') }}"></script>
    
     <script>
    $(document).ready(function () {
  
    var varForm;    
    var formURLIlotSearch = "{{ path('vae_refgpc_ilotSearch', { 'base': base|default('MP') }) }}";
    var formUrl;
    var ilot;    
        
    $('#results_ilot').on('click', '.lienDetailIlot', function () {
        $('#formIlot').hide();
        varForm = 'ilot[codeIlot] =' + $(this).attr('ilot'); // On récupère l'îlot, format pour POST
        formURL = "{{ path('vae_refgpc_ilotDetail') }}";
        ajaxForm(formURL, varForm);
    });    
       
    $('#reinitForm').on('click', function () {
        $('form[name=search_ilot_form]')[0].reset();
        $('#results_ilot').empty();
    });
 
    $('#listAll').on('click', function () {
        formURL = "{{ path('vae_refgpc_ilotSearchAll') }}";
        ajaxForm(formURL, '');
    });
    
    $('#search_ilot_form_RechercheGlobale').on('keyup', function () {
        varForm = recupFormIlot();
        formURL = formURLIlotSearch;
        ajaxForm(formURL, varForm);
    });
    
    $('#search_ilot_form_IlotText').on('keyup', function () {
        $('#search_ilot_form_IlotList').prop('selectedIndex',0);
        varForm = recupFormIlot();
        formURL = formURLIlotSearch;
        ajaxForm(formURL, varForm);
    });
    
    $('#search_ilot_form_IlotList').on('change', function () {
        $('#search_ilot_form_IlotText').val(''); // réinit de l'autre choix de l'îlot (ilot tapé)
        varForm = recupFormIlot();
        formURL = formURLIlotSearch;
        ajaxForm(formURL, varForm);
    });    
  
    $('#search_ilot_form_TypeIlot').on('change', function () {
        varForm = recupFormIlot();
        formURL = formURLIlotSearch;
        ajaxForm(formURL, varForm);
    }); 
    
    $('#search_ilot_form_Used').on('change', function () {
        varForm = recupFormIlot();
        formURL = formURLIlotSearch;
        ajaxForm(formURL, varForm);
    });
    
    $('#search_ilot_form_Competences').on('change', function () {
        varForm = recupFormIlot();
        formURL = formURLIlotSearch;
        ajaxForm(formURL, varForm);
    });     
     
    $('#search_ilot_form_ServiceDem').on('change', function () {
        varForm = recupFormIlot();
        formURL = formURLIlotSearch;
        ajaxForm(formURL, varForm);
    }); 
    
    $('#search_ilot_form_Entreprise').on('change', function () {
        varForm = recupFormIlot();
        formURL = formURLIlotSearch;
        ajaxForm(formURL, varForm);
    }); 
    
    $('#search_ilot_form_DomaineAct').on('change', function () {
        varForm = recupFormIlot();
        formURL = formURLIlotSearch;
        ajaxForm(formURL, varForm);
    }); 
    
    $('input:radio[name="search_ilot_form[Optim]"]').change(function () {
        varForm = recupFormIlot();
        formURL = formURLIlotSearch;
        ajaxForm(formURL, varForm);
    }); 
    
    $('#search_ilot_form_SiteGeo').on('change', function () {
        varForm = recupFormIlot();
        formURL = formURLIlotSearch;
        ajaxForm(formURL, varForm);
    }); 
  
});  
     </script>
    {% endblock %}
    
{% endblock %}    
    
   


    
